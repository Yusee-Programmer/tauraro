# System Programming Test for Tauraro
# Tests manual memory management and low-level operations

def test_basic_memory():
    # Allocate raw memory
    buffer = allocate(1024)
    print("Allocated 1024 bytes")
    
    # Free the memory
    free(buffer)
    print("Freed buffer successfully")
    return 1

def test_arena_memory():
    # Create a memory arena for grouped allocations
    create_arena("game_level")
    print("Created arena: game_level")
    
    # Allocate from the arena
    enemies = allocate(4096)  # Space for enemy data
    items = allocate(2048)     # Space for item data
    terrain = allocate(8192)   # Space for terrain data
    print("Allocated 14KB in arena")
    
    # Reset the arena (fast deallocation of all memory in arena)
    reset_arena("game_level")
    print("Reset arena - all memory freed at once")
    
    # Can allocate again after reset
    new_level = allocate(1024)
    print("Allocated 1KB for new level")
    
    # Destroy the arena completely
    destroy_arena("game_level")
    print("Destroyed arena")
    
    return 1

def test_multiple_arenas():
    # Multiple arenas for different subsystems
    create_arena("graphics")
    create_arena("audio")
    create_arena("physics")
    print("Created 3 arenas")
    
    # Allocate in each arena
    tex = allocate(1024)  # Graphics memory
    snd = allocate(512)   # Audio memory
    col = allocate(256)   # Physics memory
    print("Allocated in each arena")
    
    # Get memory stats
    stats = memory_stats()
    print("Memory stats:")
    print(stats)
    
    # Clean up all arenas
    destroy_arena("graphics")
    destroy_arena("audio")
    destroy_arena("physics")
    print("Destroyed all arenas")
    
    return 1

# Main entry
print("=== Tauraro System Programming Test ===")
print("")

print("--- Test 1: Basic Memory ---")
r1: int = test_basic_memory()
print("")

print("--- Test 2: Arena Memory ---")
r2: int = test_arena_memory()
print("")

print("--- Test 3: Multiple Arenas ---")
r3: int = test_multiple_arenas()
print("")

print("=== All Tests Passed ===")
