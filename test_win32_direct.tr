# Simple Win32 API Test
print("Testing direct Win32 API usage...")

# Import win32 modules directly
import win32.user32
import win32.kernel32
import win32.constants

print("Win32 modules loaded successfully!")

# Test basic functions that we know work
print("Testing MessageBox...")
result = win32.user32.MessageBoxA(0, "Hello from Win32!", "Direct Win32 Test", 0)
print(f"MessageBox result: {result}")

print("Testing Sleep...")
win32.kernel32.Sleep(1000)
print("Sleep completed!")

# Try to create a simple window
print("Attempting to create a window...")

# Get module handle
hInstance = win32.kernel32.GetModuleHandleA(0)
print(f"Module handle: {hInstance}")

# Try to create a window with a standard class
hwnd = win32.user32.CreateWindowExA(
    0,  # dwExStyle
    "Button",  # lpClassName - using a standard class
    "Test Window",  # lpWindowName
    win32.constants.WS_OVERLAPPEDWINDOW,  # dwStyle
    win32.constants.CW_USEDEFAULT,  # X
    win32.constants.CW_USEDEFAULT,  # Y
    400,  # nWidth
    300,  # nHeight
    0,  # hWndParent
    0,  # hMenu
    hInstance,  # hInstance
    0  # lpParam
)

print(f"Window handle: {hwnd}")

if hwnd:
    print("Window created successfully!")
    # Try to show the window
    win32.user32.ShowWindow(hwnd, win32.constants.SW_SHOW)
    win32.user32.UpdateWindow(hwnd)
    print("Window should be visible now...")
    
    # Keep it visible for a few seconds
    win32.kernel32.Sleep(3000)
else:
    print("Failed to create window")

print("Test completed!")